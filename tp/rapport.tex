\documentclass[12pt, letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage[document]{ragged2e}
\usepackage{amsmath}

\title{TD Calcul Numérique}
\author{BOUTON Nicolas}

\pagenumbering{gobble}

\begin{document}

\maketitle

\section*{Exercice 1}

\begin{enumerate}
\item Voir la fonction \textbf{pointgauche} dans le fichier "exo1.sci".
\item Voir la fonction \textbf{trapeze} dans le fichier "exo1.sci".
\item Voir la fonction \textbf{int\_simpson} dans le fichier "exo1.sci".
\item Voir la fonction \textbf{sin\_pi\_x} dans le fichier "exo1.sci".
\end{enumerate}

\section*{Exercice 2}

On a le système suivant :

$$
\left\{
\begin{array}{l}
  p(-3) = 3 \\
  p(-1) = 7 \\
  p(3) = 7 \\
  p(5) = -3
\end{array}
\right.
$$

Utilisons la métode des \textbf{différence divisé} :

\textit{Premiére étape :}

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  -3 & 3 \\
  -1 & 7
\end{array}
\right\}
\frac{7 - 3}{-1 - (-3)} = 2
$$

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  -1 & 7 \\
  3 & 7
\end{array}
\right\}
\frac{7 - 7}{3 - (-1)} = 0
$$

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  3 & 7 \\
  5 & -3
\end{array}
\right\}
\frac{-3 - 7}{5 - 3} = -5
$$

\textit{Deuxième étape :}

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  -3 & 2 \\
  3 & 0
\end{array}
\right\}
\frac{0 - 2}{3 -(- 3)} = -\frac{2}{6}
$$

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  -1 & 0 \\
  5 & -5
\end{array}
\right\}
\frac{-5 - 0}{5 -(- 1)} = -\frac{5}{6}
$$

\textit{Troisième étape :}

$$
\left.
\begin{array}{ll}
  x_i & y_i \\
  -3 & -\frac{2}{6} \\
  5 & -\frac{5}{6}
\end{array}
\right\}
\frac{-\frac{5}{6} - (-\frac{2}{6})}{5 -(- 3)} =
\frac{-\frac{3}{6}}{8} = -\frac{3}{48}
$$

Maintenant on peut calculer $p(x)$ :

\begin{equation*}
\begin{split}
  p(x) = & 3 + 2(x - (-3)) \\
         & + (-\frac{2}{6})(x - (-3))(x - (-1)) \\
         & -\frac{3}{48}(x - (-3))(x - (-1))(x - 3) \\
  p(x) = & 3 + 2x + 6 \\
         & -\frac{2(x + 3)(x + 1)}{6} \\
         & -\frac{3(x + 3)(x + 1)(x - 3)}{48} \\
  p(x) = & \frac{144 + 96x + 288}{48} \\
         & -\frac{(2x + 6)(x + 1)}{6} \\
         & -\frac{(3x + 9)(x + 1)(x - 3)}{48} \\
  p(x) = & \frac{144 + 96x + 288}{48} \\
         & -\frac{2x^2 + 2x + 6x + 6}{6} \\
         & -\frac{(3x^2 + 3x + 9x + 9)(x - 3)}{48} \\
  p(x) = & \frac{144 + 96x + 288}{48} \\
         & -\frac{2x^2 + 8x + 6}{6} \\
         & -\frac{3x^3 - 9x^2 + 11x^2 - 33x + 9x - 27}{48} \\
  p(x) = & \frac{144 + 96x + 288}{48} \\
         & -\frac{16x^2 + 64x + 48}{48} \\
         & -\frac{3x^3 + 2x^2 - 24x - 27}{48} \\
  p(x) = & \frac{144 + 96x + 288 - (16x^2 + 64x + 48) - (3x^3 + 2x^2 -
    24x - 27)}{48} \\
  p(x) = &  \frac{-3x^3 - 18x^2 + 56x + 411}{48} \\
  p(x) = & -\frac{3}{48}x^3 - \frac{6}{16}x^2 + \frac{7}{6}x +
  \frac{411}{48}
\end{split}
\end{equation*}

\section*{Exercice 3}

\begin{enumerate}
\item Calculons $f(-2), f(-1), f(0), f(1), f(2)$ :

  \underline{Calcul de $f(-2)$ :}
  
  \begin{equation*}
    \begin{split}
      f(-2) & = \ln(2\cos(\frac{\pi(-2)}{4})^2 + 1) \\
      f(-2) & = \ln(2(0)^2 + 1) \\
      f(-2) & = \ln(1) \\
      f(-2) & = 0
    \end{split}
  \end{equation*}

  \underline{Calcul de $f(-1)$ :}
  
  \begin{equation*}
    \begin{split}
      f(-1) & = \ln(2\cos(\frac{\pi(-1)}{4})^2 + 1) \\
      f(-1) & = \ln(2(\frac{\sqrt{2}}{2})^2 + 1) \\
      f(-1) & = \ln(2(\frac{2}{4}) + 1) \\
      f(-1) & = \ln(1 + 1) \\
      f(-1) & = \ln(2) \\
      f(-1) & = 0.6931471
    \end{split}
  \end{equation*}

  \underline{Calcul de $f(0)$ :}
  
  \begin{equation*}
    \begin{split}
      f(0) & = \ln(2\cos(\frac{\pi(0)}{4})^2 + 1) \\
      f(0) & = \ln(1) \\
      f(0) & = 0
    \end{split}
  \end{equation*}

  \underline{Calcul de $f(1)$ :}
  
  \begin{equation*}
    \begin{split}
      f(1) & = \ln(2\cos(\frac{\pi(1)}{4})^2 + 1) \\
      f(1) & = \ln(2(\frac{\sqrt{2}}{2})^2 + 1) \\
      f(1) & = \ln(2(\frac{2}{4}) + 1) \\
      f(1) & = \ln(1 + 1) \\
      f(1) & = \ln(2) \\
      f(1) & = 0.6931471
    \end{split}
  \end{equation*}

  \underline{Calcul de $f(2)$ :}
  
  \begin{equation*}
    \begin{split}
      f(2) & = \ln(2\cos(\frac{\pi(2)}{4})^2 + 1) \\
      f(2) & = \ln(2(0)^2 + 1) \\
      f(2) & = \ln(1) \\
      f(2) & = 0
    \end{split}
  \end{equation*}

  \underline{Récapitulatif :}

  $$
  \left\{
  \begin{array}{l}
    f(-2) = 0 \\
    f(-1) = 0.6931471 \\
    f(0) = 0 \\
    f(1) = 0.6931471 \\
    f(2) = 0
  \end{array}
  \right.
  $$

\item Essayons de trouver un polynôme $p$ de degré inférieur où égale
  à 3 tel que :

  \begin{equation*}
    \left\{
    \begin{array}{l}
      p(-2) = f(-2) \\
      p(-1) = f(-1) \\
      p(0) = f(0) \\
      p(-1) = f(1) \\
      p(2) = f(2) 
    \end{array}
    \right.
  \end{equation*}

  \underline{Appliquons la méthodes des différences divisé :}

  \begin{equation*}
    \left\{
    \begin{array}{l}
      p(-2) = 0 \\
      p(-1) = 0.6931471 \\
      p(0) = 0 \\
      p(-1) = 0.6931471 \\
      p(2) = 0 
    \end{array}
    \right.
  \end{equation*}

\end{enumerate}

\section*{Exercice 4}

\begin{enumerate}
\item Voir la fonction \textbf{polyLag} dans le fichier "exo4.sci".
\item Voir la fonction \textbf{myinterpol} dans le fichier "exo4.sci".
\end{enumerate}

\section*{Exercice 5}

\begin{enumerate}

\item[\textbf{1.}]\textbf{Euler Explicite}

\begin{enumerate}

\item[a.] Déterminons $y_{i+1}$ en fonction de $y_i$ :

  \begin{equation*}
    \begin{split}
      y_{i+1} & = y_i + h f(y_i) \\
      y_{i+1} & = y_i + h \frac{1}{2y_i + 1} \\
      y_{i+1} & = y_i + \frac{h}{2y_i + 1}
    \end{split}
  \end{equation*}

\item[b.] Voir la fonction \textbf{EulerExplicite} dans le fichier "exo5.sci".
  
\end{enumerate}

\item[\textbf{2.}] \textbf{Heun}

\begin{enumerate}

\item[a.] Déterminons $y_{i+1}$ en fonction de $y_i$ :

  \begin{equation*}
    \begin{split}
      y_{i+1} & = y_i + \frac{h}{2} (f(y_i + h f(y_i)) + f(y_i)) \\
      y_{i+1} & = y_i + \frac{h}{2} (\frac{1}{2(y_i + h \frac{1}{2y_i
          + 1}) + 1} + \frac{1}{2y_i + 1}) \\
      y_{i+1} & = y_i + \frac{h}{2} (\frac{1}{2y_i + \frac{2h}{2y_i
          + 1} + 1} + \frac{1}{2y_i + 1})
    \end{split}
  \end{equation*}

\item[b.] Voir la fonction \textbf{Heun} dans le fichier "exo5.sci".

\end{enumerate}

\item[\textbf{3.}] \textbf{Euler Implicite}

\begin{enumerate}
\item[a.] Déterminons un polynôme :

  \begin{equation*}
    \begin{split}
      y_{i+1} & = y_i + h f(y_{i+1}) \\
      y_{i+1} & = y_i + h \frac{1}{2y_{i+1} + 1} \\
      y_{i+1} & = \frac{y_i (2y_{i+1} + 1) + h}{2y_{i+1} + 1} \\
      y_{i+1} (2y_{i+1} + 1) & = y_i (2y_{i+1} + 1) + h \\
      2y_{i+1}^2 + y_{i+1} & = y_i + 2y_{i+1}y_i + h \\
      2y_{i+1}^2 + y_{i+1} - 2y_{i+1}y_i & = y_i + h \\
      2y_{i+1}^2 + y_{i+1} - 2y_{i+1}y_i - y_i - h & = 0 \\
      2y_{i+1}^2 + (1 - 2y_i) y_{i+1} - y_i - h & = 0
    \end{split}
  \end{equation*}

\item[b.] Calculons le descriminant :

    \begin{equation*}
    \begin{split}
      \Delta & = b^2 - 4ac \\
      \Delta & = (1 - 2y_i)^2 - [4 * 2 * (- y_i - h)] \\
      \Delta & = (1 - 2y_i)^2 + 8y_i + 8h \\
      \Delta & = 1 - 4y_i + (2y_i)^2 + 8y_i + 8h \\
      \Delta & = 1 + 4y_i + (2y_i)^2 + 8h \\
      \Delta & = (2y_i + 1)^2 + 8h
    \end{split}
  \end{equation*}

\item[c.] Déterminons $y_{i+1}$ en fontion de $y_i$ et $h$ :

  \begin{equation*}
    \begin{split}
      y_{i+1} & = \frac{- b + \sqrt{\Delta}}{2a} \\
      y_{i+1} & = \frac{2y_i - 1 + \sqrt{(2y_i + 1)^2 + 8h}}{4} 
    \end{split}
  \end{equation*}

\item[d.] Voir la fonction \textbf{EulerImplicite} dans le fichier "exo5.sci".
  
\end{enumerate}

\item[\textbf{4.}] \textbf{Affichage}

\begin{enumerate}
\item[a.] Correspondances des colonnes :

  \begin{itemize}
  \item C2 : Euler Explicite, car les résultats obtenus sont
    inférieurs aux résultats exactes.
  \item C3 : Heun, car c'est la méthode qui à la convergence la plus forte
  \item C4 : Euler Implicite, car les résultats obtenus sont
    supérieurs aux résultats exactes.
  \end{itemize}

\item[b.] Voir la fonction \textbf{AfficheRes} dans le fichier
  "exo5.sci".

\item[c.] Calculons le taux d'erreurs des 3 méthodes :

  \underline{Taux d'erreur avec la méthode d'Euler Explicite :}

  \begin{equation*}
    \begin{split}
      \left\lvert e - e' \right\rvert & = \left\lvert 0,5630146 - 0,5731410
        \right\rvert \\
        & = 0.0101264 \\
        & = 1.01264 \%
    \end{split}
  \end{equation*}

  \underline{Taux d'erreur avec la méthode d'Heun :}

  \begin{equation*}
    \begin{split}
      \left\lvert e - e' \right\rvert & = \left\lvert 0,5630146 - 0,5630245
        \right\rvert \\
        & = 0.0000099 \\
        & = 0.00099 \%
    \end{split}
  \end{equation*}

  \underline{Taux d'erreur avec la méthode d'Euler Implicite :}

  \begin{equation*}
    \begin{split}
      \left\lvert e - e' \right\rvert & = \left\lvert 0,5630146 - 0,5535927
        \right\rvert \\
        & = 0.0094219 \\
        & = 0.94219 \%
    \end{split}
  \end{equation*}

  Nous voyons clairement que les deux méthodes d'Euler sont presque
  équivalentes en termes de convergences exepté qu'elles convergent
  dans des sens différents, les valeurs d'Euler Explicite sont de plus
  en plus grandes que celles attendus et les valeurs d'Euler Implicite
  sont de plus en plus petites des valeurs ettendus.
  On voit également que le taux d'érreur est quasiment nulle pour la
  méthode d'Heun.
\end{enumerate}

\end{enumerate}

\section*{Exercice 6}

\section*{Exercice 7}

\section*{Exercice 8}

\end{document}
